{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 12, "column": 0}, "map": {"version":3,"sources":["file:///home/fanti/Desktop/iqlaav3/src/app/responses/page.tsx"],"sourcesContent":["\n\"use client\";\nimport React, { useEffect, useState } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport { getFirestore, collection, getDocs } from 'firebase/firestore';\n\n// TODO: Replace with your Firebase config\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDuBbgwcJR0wWJMq7CFV-VgZMqNtFzDPko\",\n  authDomain: \"iqlaa-9b951.firebaseapp.com\",\n  projectId: \"iqlaa-9b951\",\n  storageBucket: \"iqlaa-9b951.firebasestorage.app\",\n  messagingSenderId: \"728888284570\",\n  appId: \"1:728888284570:web:af08032d700e028a029623\",\n  measurementId: \"G-YVR4ERB4BJ\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst db = getFirestore(app);\n// console.log(\"Firebase db: \", db);\ntype ResponseData = {\n    id: string;\n    [key: string]: any;\n};\n\n\n// load questions from the questions.json file\nimport questions from '../questions.json';\n\nfunction getQuestionText(questionId: string, questions: { id: string; question: string }[]) {\n  const q = questions.find(q => q.id === questionId);\n  return q ? q.question : \"Unknown question\";\n}\n\n\n\ntype Question = {\n  id: string;\n  question: string;\n  type: string;\n  options?: string[];\n};\nconst _questions: Question[] = questions.questions || [];\n\n\n\n\n\n\nconst Responses: React.FC = () => {\n  const [responses, setResponses] = useState<ResponseData[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [stats, setStats] = useState<any>({});\n\n  useEffect(() => {\n    const fetchResponses = async () => {\n      try {\n        const querySnapshot = await getDocs(collection(db, 'users'));\n        const data = querySnapshot.docs.map(doc => ({\n          id: doc.id,\n          ...doc.data(),\n        }));\n        setResponses(data);\n        console.log(\"Fetched responses: \", data);\n      } catch (error) {\n        console.error('Error fetching responses:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchResponses();\n  }, []);\n\n  useEffect(() => {\n    // Calculate stats after responses are loaded\n    const newStats: any = {};\n    _questions.forEach(q => {\n      if (q.type === \"multiple_choice\" && q.options) {\n        newStats[q.id] = {};\n        q.options.forEach(option => {\n          newStats[q.id][option] = 0;\n        });\n      }\n    });\n    responses.forEach(userResponse => {\n      userResponse.responses?.forEach((answerObj: any) => {\n        const { questionId, answer } = answerObj;\n        if (newStats[questionId] && newStats[questionId][answer] !== undefined) {\n          newStats[questionId][answer]++;\n        }\n      });\n    });\n    setStats(newStats);\n    if (Object.keys(newStats).length > 0) {\n      console.log(\"Stats: \", newStats);\n    }\n  }, [responses]);\n\n  if (loading) return <div>Loading...</div>;\n  // clculate totale user responses\n  let totalResponses = \"إجمالي عدد الإجابات: \" + responses.length;\n\n  return (\n    <div className='bg-gray-800 flex flex-col items-center justify-center' dir=\"rtl\">\n      <h2 className='mt-10 mb-2 text-4xl font-bold text-center mb-10' style={{color: \"cyan\"}}>{totalResponses}</h2>\n      <ul className='w-[50%] flex flex-col gap-8 mb-50' style={{ minWidth: 300 }}>\n        {_questions.filter(q => q.type === 'multiple_choice').map(q => (\n          <li key={q.id} className='bg-gray-700 rounded-lg p-3' style={{}} >\n            <div className='font-bold mb-8' style={{color: \"#e7e7e7ff\", fontSize: \"20px\"}}>{q.question}</div>\n            <ul className=' flex flex-col gap-2'>\n              {q.options && [...q.options]\n                .sort((a, b) => (stats[q.id]?.[b] ?? 0) - (stats[q.id]?.[a] ?? 0))\n                .map(option => {\n                const count = stats[q.id]?.[option] ?? 0;\n                const total: any = Object.values(stats[q.id] || {}).reduce((a, b) => Number(a) + Number(b), 0);\n                const percent = total > 0 ? (count / total) * 100 : 0;\n\n                return (\n                  <li key={option} className='mb-1'>\n                    <div className='relative h-full w-full rounded-lg bg-green-900' style={{zIndex: '0', height: '2.75rem'}} >\n                      <div className='absolute top-0 h-full rounded-lg bg-green-700'\n                        style={{width: `${percent}%`, zIndex: 1, transition: 'width 0.5s', background: \"#6b6b6b7e\"}} />\n\n                      <div className='relative z-10 p-4 flex items-center h-full w-full justify-between' style={{color: \"white\"}}>\n                        <span className='font-bold'>{option}</span>\n                        <span className=\"text-gray-50 font-medium\">{percent.toFixed(0)}% - {count}</span>\n                      </div>\n                    </div>\n                  </li>\n                );\n              })}\n            </ul>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default Responses;"],"names":[],"mappings":"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","debugId":null}}]
}